{"version":3,"sources":["../api/services/UploadService.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,kDAAgE;AAChE,wDAAgC;AAChC,+CAAiD;AAEjD,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,OAAO,CAAC,GAAG,CAAC;AACxC,QAAA,KAAK,GAAG,MAAM,IAAI,SAAS,IAAI,SAAS,CAAC;AAEzC,QAAA,EAAE,GAAG,aAAK,CAAC,CAAC,CAAC,IAAI,oBAAQ,CAAC;IACrC,uEAAuE;IACvE,uDAAuD;IACvD,UAAU,EAAE,YAAY;IAExB,QAAQ,EAAE,qCAAqC;IAE/C,WAAW,EAAE;QACX,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,MAAM;QAC/B,eAAe,EAAE,OAAO,CAAC,GAAG,CAAC,SAAS;KACvC;CACF,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;AAEH,MAAM,aAAa,GAAG,CAAO,GAAW,EAAE,SAAiB,EAAmB,EAAE;IACrF,IAAI,CAAC,aAAK;QAAE,OAAO;IACnB,MAAM,QAAQ,GAAG,IAAA,8BAAgB,EAAC,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC,CAAC;IAC/D,MAAM,MAAM,GAAG,MAAM,IAAA,kBAAQ,EAAC,GAAG,EAAE,MAAM,CAAC,CAAC;IAC3C,MAAM,UAAE,CAAC,IAAI,CACT,IAAI,4BAAgB,CAAC;QACrB,MAAM,EAAE,SAAS;QACjB,GAAG,EAAE,QAAQ;QACb,IAAI,EAAE,MAAM;QACZ,GAAG,EAAE,aAAa;QAClB,YAAY,EAAE,qBAAqB;KACpC,CAAC,CACH,CAAC;IACF,OAAO,QAAQ,CAAA;AACjB,CAAC,CAAA,CAAC;AAdW,QAAA,aAAa,iBAcxB","file":"UploadService.js","sourcesContent":["import { S3Client, PutObjectCommand } from '@aws-sdk/client-s3';\nimport download from 'download';\nimport { generateFilename } from './UtilService';\n\nconst { S3_KEY, S3_SECRET, S3_BUCKET } = process.env;\nexport const hasS3 = S3_KEY && S3_SECRET && S3_BUCKET;\n\nexport const s3 = hasS3 ? new S3Client({\n  // The key apiVersion is no longer supported in v3, and can be removed.\n  // @deprecated The client uses the \"latest\" apiVersion.\n  apiVersion: '2006-03-01',\n\n  endpoint: 'https://sfo3.digitaloceanspaces.com',\n\n  credentials: {\n    accessKeyId: process.env.S3_KEY,\n    secretAccessKey: process.env.S3_SECRET,\n  },\n}) : null;\n\nexport const uploadFromUrl = async (url: string, extension: string): Promise<string> => {\n  if (!hasS3) return;\n  const filename = generateFilename({ originalname: extension });\n  const buffer = await download(url, 'dist');\n  await s3.send(\n      new PutObjectCommand({\n      Bucket: S3_BUCKET,\n      Key: filename,\n      Body: buffer,\n      ACL: 'public-read',\n      StorageClass: 'INTELLIGENT_TIERING',\n    })\n  );\n  return filename\n};\n"],"sourceRoot":"../../../src"}