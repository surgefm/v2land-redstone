{"version":3,"sources":["../api/services/NewsService/getContribution.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,yCAA4C;AAC5C,qCAAyC;AAEzC,SAAe,eAAe,CAC5B,IAA8C,EAC9C,QAAiB,EACjB,EAAE,WAAW,KAAmC,EAAE;;QAElD,MAAM,OAAO,GAAG,MAAM,gBAAM,CAAC,OAAO,CAAC;YACnC,UAAU,EAAE,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;gBACjC,OAAO,EAAE,CAAC,MAAM,EAAE,QAAQ,CAAC;aAC5B;YACD,KAAK,EAAE;gBACL,MAAM,EAAE;oBACN,CAAC,cAAE,CAAC,EAAE,CAAC,EAAE,CAAC,kBAAkB,EAAE,kBAAkB,EAAE,YAAY,CAAC;iBAChE;gBACD,MAAM,EAAE,IAAI,CAAC,EAAE;aAChB;YACD,OAAO,EAAE,CAAC;oBACR,KAAK,EAAE,gBAAM;oBACb,EAAE,EAAE,SAAS;oBACb,QAAQ,EAAE,KAAK;oBACf,UAAU,EAAE,CAAC,UAAU,EAAE,MAAM,EAAE,IAAI,CAAC;iBACvC,CAAC;YACF,WAAW;SACZ,CAAC,CAAC;QAEH,OAAO,OAAO,CAAC;IACjB,CAAC;CAAA;AAED,kBAAe,eAAe,CAAC","file":"getContribution.js","sourcesContent":["import { Op, Transaction } from 'sequelize';\nimport { Client, Record } from '@Models';\n\nasync function getContribution (\n  news: { id?: number; contribution?: Record[] },\n  withData: boolean,\n  { transaction }: { transaction?: Transaction} = {},\n) {\n  const records = await Record.findAll({\n    attributes: withData ? undefined : {\n      exclude: ['data', 'before'],\n    },\n    where: {\n      action: {\n        [Op.or]: ['updateNewsStatus', 'updateNewsDetail', 'createNews'],\n      },\n      target: news.id,\n    },\n    include: [{\n      model: Client,\n      as: 'ownedBy',\n      required: false,\n      attributes: ['username', 'role', 'id'],\n    }],\n    transaction,\n  });\n\n  return records;\n}\n\nexport default getContribution;\n"],"sourceRoot":"../../../../src"}