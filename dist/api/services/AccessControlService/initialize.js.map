{"version":3,"sources":["../api/services/AccessControlService/initialize.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,mCAA0E;AAC1E,6CAAkE;AAElE,SAA8B,UAAU;;QACtC,4BAA4B;QAC5B,MAAM,IAAA,kBAAK,EAAC,cAAM,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,MAAM,CAAC,EAAE,MAAM,CAAC,CAAC;QAE1D,kCAAkC;QAClC,MAAM,IAAA,2BAAc,EAAC,oBAAY,EAAE,cAAM,CAAC,CAAC;QAC3C,MAAM,IAAA,kBAAK,EAAC,oBAAY,EAAE,QAAQ,EAAE,CAAC,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;QAC7E,MAAM,IAAA,kBAAK,EAAC,oBAAY,EAAE,QAAQ,EAAE,CAAC,QAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;QAClE,MAAM,IAAA,kBAAK,EAAC,oBAAY,EAAE,MAAM,EAAE,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC,CAAC;QAExD,6BAA6B;QAC7B,MAAM,IAAA,2BAAc,EAAC,eAAO,EAAE,oBAAY,CAAC,CAAC;QAC5C,MAAM,IAAA,kBAAK,EAAC,eAAO,EAAE,WAAW,EAAE,GAAG,CAAC,CAAC;QACvC,MAAM,IAAA,kBAAK,EAAC,eAAO,EAAE,MAAM,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;QACvC,MAAM,IAAA,kBAAK,EAAC,eAAO,EAAE,qBAAqB,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;QAC9D,MAAM,IAAA,wBAAW,EAAC,eAAO,EAAE,YAAY,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;QAE3D,8BAA8B;QAC9B,MAAM,IAAA,2BAAc,EAAC,gBAAQ,EAAE,eAAO,CAAC,CAAC;QACxC,MAAM,IAAA,kBAAK,EAAC,gBAAQ,EAAE,UAAU,EAAE,GAAG,CAAC,CAAC;QACvC,MAAM,IAAA,kBAAK,EAAC,gBAAQ,EAAE,YAAY,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;QAEtD,4BAA4B;QAC5B,MAAM,IAAA,2BAAc,EAAC,cAAM,EAAE,eAAO,CAAC,CAAC;QACtC,MAAM,IAAA,kBAAK,EAAC,cAAM,EAAE,gBAAgB,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;QAC5E,MAAM,IAAA,kBAAK,EAAC,cAAM,EAAE,aAAa,EAAE,MAAM,CAAC,CAAC;QAE3C,0CAA0C;QAC1C,kCAAkC;QAClC,mCAAmC;QACnC,6CAA6C;QAC7C,4CAA4C;QAC5C,+CAA+C;QAC/C,2CAA2C;QAC3C,8CAA8C;QAC9C,aAAa;QACb,mDAAmD;QACnD,MAAM;QACN,IAAI;IACN,CAAC;CAAA;AAvCD,6BAuCC","file":"initialize.js","sourcesContent":["import { guests, contributors, editors, managers, admins } from './roles';\nimport { allow, addRoleParents, removeAllow } from './operations';\n\nexport default async function initialize(): Promise<void> {\n  // Define guests’ permission\n  await allow(guests, ['events', 'stacks', 'news'], 'view');\n\n  // Define contributors’ permission\n  await addRoleParents(contributors, guests);\n  await allow(contributors, 'events', ['create', 'edit', 'publish', 'delete']);\n  await allow(contributors, 'stacks', ['create', 'edit', 'delete']);\n  await allow(contributors, 'news', ['create', 'delete']);\n\n  // Define editors’ permission\n  await addRoleParents(editors, contributors);\n  await allow(editors, 'headlines', '*');\n  await allow(editors, 'news', ['edit']);\n  await allow(editors, 'all-admitted-events', ['view', 'edit']);\n  await removeAllow(editors, 'all-events', ['view', 'edit']);\n\n  // Define managers’ permission\n  await addRoleParents(managers, editors);\n  await allow(managers, 'all-tags', '*');\n  await allow(managers, 'all-events', ['view', 'edit']);\n\n  // Define admins’ permission\n  await addRoleParents(admins, editors);\n  await allow(admins, 'no-admin-roles', ['view', 'create', 'edit', 'delete']);\n  await allow(admins, 'admin-roles', 'view');\n\n  // const clients = await Client.findAll();\n  // for (const client of clients) {\n  //   if (client.role === 'admin') {\n  //     await addUserRoles(client.id, admins);\n  //   } else if (client.role === 'manager') {\n  //     await addUserRoles(client.id, managers);\n  //   } else if (client.role === 'editor') {\n  //     await addUserRoles(client.id, editors);\n  //   } else {\n  //     await addUserRoles(client.id, contributors);\n  //   }\n  // }\n}\n"],"sourceRoot":"../../../../src"}