{"version":3,"sources":["../api/services/AccessControlService/EventAccessControl/setClientEventOwner.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,qCAAgC;AAChC,uEAAyD;AACzD,0EAAyE;AACzE,mDAAoD;AACpD,4FAAoE;AACpE,4FAAoE;AACpE,gGAAwE;AAExE,SAA8B,mBAAmB,CAAC,QAAgB,EAAE,OAAe,EAAE,EAAW;;QAC9F,MAAM,IAAA,mCAAyB,EAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACnD,MAAM,IAAA,mCAAyB,EAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACnD,MAAM,IAAA,qCAA2B,EAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACrD,MAAM,KAAK,GAAG,MAAM,eAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QAC5C,IAAI,KAAK,EAAE;YACT,KAAK,CAAC,OAAO,GAAG,QAAQ,CAAC;YACzB,MAAM,KAAK,CAAC,IAAI,EAAE,CAAC;SACpB;QACD,IAAI,EAAE,EAAE;YACN,MAAM,aAAa,CAAC,MAAM,CAAC;gBACzB,KAAK,EAAE,QAAQ;gBACf,MAAM,EAAE,qBAAqB;gBAC7B,MAAM,EAAE,QAAQ;gBAChB,SAAS,EAAE,OAAO;gBAClB,KAAK,EAAE,EAAE;aACV,CAAC,CAAC;SACJ;QACD,OAAO,IAAA,yBAAY,EAAC,QAAQ,EAAE,MAAM,IAAA,iCAAiB,EAAC,OAAO,CAAC,CAAC,CAAC;IAClE,CAAC;CAAA;AAnBD,sCAmBC","file":"setClientEventOwner.js","sourcesContent":["import { Event } from '@Models';\nimport * as RecordService from '@Services/RecordService';\nimport { addUserRoles } from '@Services/AccessControlService/operations';\nimport { getEventOwnerRole } from './getEventRoles';\nimport disallowClientToViewEvent from './disallowClientToViewEvent';\nimport disallowClientToEditEvent from './disallowClientToEditEvent';\nimport disallowClientToManageEvent from './disallowClientToManageEvent';\n\nexport default async function setClientEventOwner(clientId: number, eventId: number, by?: number) {\n  await disallowClientToViewEvent(clientId, eventId);\n  await disallowClientToEditEvent(clientId, eventId);\n  await disallowClientToManageEvent(clientId, eventId);\n  const event = await Event.findByPk(eventId);\n  if (event) {\n    event.ownerId = clientId;\n    await event.save();\n  }\n  if (by) {\n    await RecordService.create({\n      model: 'Client',\n      action: 'setClientEventOwner',\n      target: clientId,\n      subtarget: eventId,\n      owner: by,\n    });\n  }\n  return addUserRoles(clientId, await getEventOwnerRole(eventId));\n}\n"],"sourceRoot":"../../../../../src"}