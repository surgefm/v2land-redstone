{"version":3,"sources":["../api/services/EventService/updateAdmittedLatestNews.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,qCAAgC;AAGhC,SAAe,wBAAwB,CAAC,OAAe,EAAE,EAAE,WAAW,EAErE;;QACC,MAAM,KAAK,GAAG,MAAM,eAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QAC5C,MAAM,kBAAkB,GAAG,MAAM,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE;YAClD,KAAK,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE;YAC7B,KAAK,EAAE,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YACzB,WAAW;SACZ,CAAC,CAAC;QACH,IAAI,kBAAkB,CAAC,MAAM,KAAK,CAAC;YAAE,OAAO;QAC5C,KAAK,CAAC,oBAAoB,GAAG,kBAAkB,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QACtD,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,CAAC,CAAC;IACpC,CAAC;CAAA;AAED,kBAAe,wBAAwB,CAAC","file":"updateAdmittedLatestNews.js","sourcesContent":["import { Event } from '@Models';\nimport { Transaction } from 'sequelize';\n\nasync function updateAdmittedLatestNews(eventId: number, { transaction }: {\n  transaction?: Transaction;\n}) {\n  const event = await Event.findByPk(eventId);\n  const latestAdmittedNews = await event.$get('news', {\n    where: { status: 'admitted' },\n    order: [['time', 'DESC']],\n    transaction,\n  });\n  if (latestAdmittedNews.length === 0) return;\n  event.latestAdmittedNewsId = latestAdmittedNews[0].id;\n  await event.save({ transaction });\n}\n\nexport default updateAdmittedLatestNews;\n"],"sourceRoot":"../../../../src"}