{"version":3,"sources":["../api/services/AgentService/tools.ts"],"names":[],"mappings":"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","file":"tools.js","sourcesContent":["import Exa from 'exa-js';\nimport { randomUUID } from 'crypto';\nimport { Client, Event, News, Stack, EventStackNews, AgentStatus, Subscription, sequelize } from '@Models';\nimport * as EventService from '@Services/EventService';\nimport * as StackService from '@Services/StackService';\nimport * as AlgoliaService from '@Services/AlgoliaService';\nimport * as RecordService from '@Services/RecordService';\nimport * as ChatService from '@Services/ChatService';\nimport * as RedisService from '@Services/RedisService';\nimport { setClientEventOwner, isAllowedToEditEvent } from '@Services/AccessControlService';\nimport * as AgentLock from './lock';\nimport { SYSTEM_PROMPT } from '../../mcp/mcpInstruction';\nimport type { ChatCompletionTool } from 'openai/resources/chat/completions';\n\nlet _exa: Exa | null = null;\nfunction getExa(): Exa {\n  if (!_exa) {\n    _exa = new Exa(process.env.EXA_API_KEY);\n  }\n  return _exa;\n}\n\nexport interface ToolContext {\n  eventId: number;\n  clientId: number;\n  botClientId: number;\n  runId: string;\n  source?: 'mcp' | 'agent';\n}\n\nexport const TOOL_DEFINITIONS: ChatCompletionTool[] = [\n  {\n    type: 'function',\n    function: {\n      name: 'search_news',\n      description: 'Search for news articles about a topic using web search. Use this to find news relevant to the timeline. Supports date range filtering — use startDate to search further back for timelines that have not been updated recently.',\n      parameters: {\n        type: 'object',\n        properties: {\n          query: {\n            type: 'string',\n            description: 'Search query describing the news topic to find',\n          },\n          numResults: {\n            type: 'number',\n            description: 'Number of results to return (default 20, max 40)',\n          },\n          startDate: {\n            type: 'string',\n            description: 'Start of date range for article publication (ISO 8601 date, e.g. \"2025-01-15\"). Defaults to 7 days ago. Use an earlier date for timelines that have not been updated recently.',\n          },\n          endDate: {\n            type: 'string',\n            description: 'End of date range for article publication (ISO 8601 date). Defaults to today.',\n          },\n        },\n        required: ['query'],\n      },\n    },\n  },\n  {\n    type: 'function',\n    function: {\n      name: 'get_current_stacks',\n      description: 'Get the current state of the timeline, including all stacks (progress entries), their news items, and off-shelf news. Call this to understand what already exists before making changes.',\n      parameters: {\n        type: 'object',\n        properties: {},\n      },\n    },\n  },\n  {\n    type: 'function',\n    function: {\n      name: 'create_stack',\n      description: 'Create a new progress entry (stack) in the timeline. Each stack represents a distinct development in the event.',\n      parameters: {\n        type: 'object',\n        properties: {\n          title: {\n            type: 'string',\n            description: 'Brief title describing this development',\n          },\n          description: {\n            type: 'string',\n            description: 'Factual, detailed summary of what happened (2-4 sentences)',\n          },\n          time: {\n            type: 'string',\n            description: 'When the real-world development described by this stack actually took place (ISO 8601 format). This should be the date of the event itself, not the article publication date.',\n          },\n          order: {\n            type: 'number',\n            description: 'Display order (higher = more recent, default -1 for auto)',\n          },\n        },\n        required: ['title', 'description', 'time'],\n      },\n    },\n  },\n  {\n    type: 'function',\n    function: {\n      name: 'add_news_to_event',\n      description: 'Add a news article to the event. Optionally assign it to a specific stack. The news will appear in the newsroom.',\n      parameters: {\n        type: 'object',\n        properties: {\n          url: {\n            type: 'string',\n            description: 'URL of the news article',\n          },\n          source: {\n            type: 'string',\n            description: 'Name of the news source/outlet',\n          },\n          title: {\n            type: 'string',\n            description: 'Title of the news article',\n          },\n          abstract: {\n            type: 'string',\n            description: 'Brief summary of the article (max 200 chars)',\n          },\n          time: {\n            type: 'string',\n            description: 'Publication time (ISO 8601 format)',\n          },\n          stackId: {\n            type: 'number',\n            description: 'ID of the stack to add this news to (optional, omit to add off-shelf)',\n          },\n        },\n        required: ['url', 'source', 'title', 'time'],\n      },\n    },\n  },\n  {\n    type: 'function',\n    function: {\n      name: 'add_news_to_stack',\n      description: 'Move an existing news item into a specific stack.',\n      parameters: {\n        type: 'object',\n        properties: {\n          newsId: {\n            type: 'number',\n            description: 'ID of the news item to move',\n          },\n          stackId: {\n            type: 'number',\n            description: 'ID of the stack to add the news to',\n          },\n        },\n        required: ['newsId', 'stackId'],\n      },\n    },\n  },\n  {\n    type: 'function',\n    function: {\n      name: 'update_stack',\n      description: 'Update an existing stack\\'s title, description, or time.',\n      parameters: {\n        type: 'object',\n        properties: {\n          stackId: {\n            type: 'number',\n            description: 'ID of the stack to update',\n          },\n          description: {\n            type: 'string',\n            description: 'New description for the stack',\n          },\n          title: {\n            type: 'string',\n            description: 'New title for the stack',\n          },\n          time: {\n            type: 'string',\n            description: 'New date/time for when the development described by this stack actually took place (ISO 8601 format)',\n          },\n        },\n        required: ['stackId'],\n      },\n    },\n  },\n  {\n    type: 'function',\n    function: {\n      name: 'reorder_stacks',\n      description: 'Rearrange the display order of stacks in the timeline. Provide stack IDs in the desired order, from most recent (first) to oldest (last).',\n      parameters: {\n        type: 'object',\n        properties: {\n          stackIds: {\n            type: 'array',\n            items: { type: 'number' },\n            description: 'Array of stack IDs in desired display order (most recent first)',\n          },\n        },\n        required: ['stackIds'],\n      },\n    },\n  },\n  {\n    type: 'function',\n    function: {\n      name: 'send_chat_message',\n      description: 'Send a message to the newsroom chatroom. Use this to report progress, share findings, or communicate with editors.',\n      parameters: {\n        type: 'object',\n        properties: {\n          text: {\n            type: 'string',\n            description: 'Message text to send',\n          },\n        },\n        required: ['text'],\n      },\n    },\n  },\n  {\n    type: 'function',\n    function: {\n      name: 'ask_user_question',\n      description: 'Ask the user a clarification question with multiple-choice options. The user can pick one of the provided options or reply with a free-form answer. Use this when the user\\'s instructions are ambiguous and you need clarification before proceeding. This tool will pause execution and wait for the user\\'s response.',\n      parameters: {\n        type: 'object',\n        properties: {\n          question: {\n            type: 'string',\n            description: 'The clarification question to ask the user',\n          },\n          options: {\n            type: 'array',\n            items: { type: 'string' },\n            description: 'List of multiple-choice options for the user to choose from (2-6 options)',\n          },\n        },\n        required: ['question', 'options'],\n      },\n    },\n  },\n];\n\nfunction recordData(data: any, ctx: ToolContext): any {\n  const plain = typeof data?.get === 'function' ? data.get({ plain: true }) : data;\n  if (ctx.source === 'mcp') {\n    return { ...plain, viaMcp: true };\n  }\n  return plain;\n}\n\nexport async function executeTool(\n  name: string,\n  args: Record<string, any>,\n  ctx: ToolContext,\n): Promise<string> {\n  try {\n    switch (name) {\n      case 'search_news':\n        return await searchNews(args as any, ctx);\n      case 'get_current_stacks':\n        return await getCurrentStacks(ctx);\n      case 'create_stack':\n        return await createStack(args as any, ctx);\n      case 'add_news_to_event':\n        return await addNewsToEvent(args as any, ctx);\n      case 'add_news_to_stack':\n        return await addNewsToStack(args as any, ctx);\n      case 'update_stack':\n        return await updateStack(args as any, ctx);\n      case 'reorder_stacks':\n        return await reorderStacks(args as any, ctx);\n      case 'send_chat_message':\n        return await sendChatMessage(args as any, ctx);\n      case 'ask_user_question':\n        return await askUserQuestion(args as any, ctx);\n      case 'create_event':\n        return await createEvent(args as any, ctx);\n      case 'get_newsroom_link':\n        return await getNewsroomLink(ctx);\n      case 'update_event':\n        return await updateEventTool(args as any, ctx);\n      case 'remove_news_from_stack':\n        return await removeNewsFromStack(args as any, ctx);\n      case 'search_events':\n        return await searchEventsInDb(args as any);\n      case 'get_editorial_guidelines':\n        return await getEditorialGuidelines();\n      case 'get_followed_editable_events':\n        return await getFollowedEditableEvents(ctx);\n      case 'get_owned_editable_events':\n        return await getOwnedEditableEvents(ctx);\n      default:\n        return JSON.stringify({ error: `Unknown tool: ${name}` });\n    }\n  } catch (err: any) {\n    return JSON.stringify({ error: err.message || String(err) });\n  }\n}\n\nasync function searchNews(\n  args: { query: string; numResults?: number; startDate?: string; endDate?: string },\n  ctx: ToolContext,\n): Promise<string> {\n  const numResults = Math.min(args.numResults || 20, 40);\n\n  // Default to 7 days ago if not specified\n  const startDate = args.startDate || (() => {\n    const d = new Date();\n    d.setDate(d.getDate() - 7);\n    return d.toISOString().split('T')[0];\n  })();\n\n  const searchOptions: any = {\n    category: 'news',\n    numResults,\n    startPublishedDate: startDate,\n    contents: {\n      text: { maxCharacters: 500 },\n    },\n  };\n\n  if (args.endDate) {\n    searchOptions.endPublishedDate = args.endDate;\n  }\n\n  const result = await getExa().search(args.query, searchOptions);\n\n  const articles = result.results.map((r: any) => ({\n    title: r.title,\n    url: r.url,\n    publishedDate: r.publishedDate,\n    author: r.author,\n    text: r.text,\n  }));\n\n  return JSON.stringify({ articles, count: articles.length });\n}\n\nasync function getCurrentStacks(ctx: ToolContext): Promise<string> {\n  const event = await EventService.findEvent(ctx.eventId, {\n    plain: true,\n    getNewsroomContent: true,\n  });\n\n  if (!event) {\n    return JSON.stringify({ error: 'Event not found' });\n  }\n\n  const stacks = (event.stacks || []).map((s: any) => ({\n    id: s.id,\n    title: s.title,\n    description: s.description,\n    status: s.status,\n    order: s.order,\n    time: s.time,\n    news: (s.news || []).map((n: any) => ({\n      id: n.id,\n      title: n.title,\n      url: n.url,\n      source: n.source,\n      time: n.time,\n      abstract: n.abstract,\n    })),\n  }));\n\n  const offshelfNews = (event.offshelfNews || []).map((n: any) => ({\n    id: n.id,\n    title: n.title,\n    url: n.url,\n    source: n.source,\n    time: n.time,\n    abstract: n.abstract,\n  }));\n\n  return JSON.stringify({\n    eventName: event.name,\n    eventDescription: event.description,\n    stacks,\n    offshelfNews,\n  });\n}\n\nasync function createStack(\n  args: { title: string; description: string; time: string; order?: number },\n  ctx: ToolContext,\n): Promise<string> {\n  const stack = await StackService.createStack(\n    ctx.eventId,\n    {\n      title: args.title,\n      description: args.description,\n      time: new Date(args.time),\n      order: args.order || -1,\n    },\n    ctx.clientId,\n  );\n\n  return JSON.stringify({\n    success: true,\n    stackId: stack.id,\n    title: stack.title,\n  });\n}\n\nasync function addNewsToEvent(\n  args: {\n    url: string;\n    source: string;\n    title: string;\n    abstract?: string;\n    time: string;\n    stackId?: number;\n  },\n  ctx: ToolContext,\n): Promise<string> {\n  let newsId: number;\n  let created = false;\n\n  await sequelize.transaction(async (transaction) => {\n    let news = await News.findOne({\n      where: { url: args.url },\n      transaction,\n    });\n\n    if (news) {\n      const existing = await EventStackNews.findOne({\n        where: { eventId: ctx.eventId, newsId: news.id },\n      });\n      if (existing) {\n        throw new Error(`News with this URL already exists in the event (newsId: ${news.id})`);\n      }\n    }\n\n    const time = new Date();\n    if (!news) {\n      news = await News.create(\n        {\n          url: args.url,\n          source: args.source,\n          title: args.title,\n          abstract: args.abstract ? args.abstract.slice(0, 200) : undefined,\n          time: new Date(args.time),\n          status: 'admitted',\n        },\n        { transaction },\n      );\n      created = true;\n\n      await RecordService.create(\n        {\n          model: 'News',\n          data: recordData(news, ctx),\n          target: news.id,\n          action: 'createNews',\n          owner: ctx.clientId,\n          createdAt: time,\n        },\n        { transaction },\n      );\n    }\n\n    newsId = news.id;\n\n    const eventStackNews = await EventStackNews.create(\n      {\n        eventId: ctx.eventId,\n        stackId: args.stackId || undefined,\n        newsId: news.id,\n      },\n      { transaction },\n    );\n\n    await RecordService.create(\n      {\n        model: 'EventStackNews',\n        data: recordData(eventStackNews, ctx),\n        target: ctx.eventId,\n        subtarget: news.id,\n        action: 'addNewsToEvent',\n        owner: ctx.clientId,\n        createdAt: time,\n      },\n      { transaction },\n    );\n\n    if (args.stackId) {\n      await RecordService.create(\n        {\n          model: 'EventStackNews',\n          data: recordData(eventStackNews, ctx),\n          target: args.stackId,\n          subtarget: news.id,\n          action: 'addNewsToStack',\n          owner: ctx.clientId,\n          createdAt: time,\n        },\n        { transaction },\n      );\n    }\n\n    // Emit socket events for real-time newsroom updates\n    const socket = await EventService.getNewsroomSocket(ctx.eventId);\n    const event = await EventService.findEvent(ctx.eventId, { eventOnly: true });\n    const client = await Client.findByPk(ctx.clientId);\n    socket.emit('add news to event', {\n      eventStackNews,\n      event,\n      news,\n      client,\n    });\n\n    if (args.stackId) {\n      const stack = await Stack.findByPk(args.stackId, { transaction });\n      socket.emit('add news to stack', {\n        eventStackNews,\n        stack,\n        news,\n        client,\n      });\n    }\n  });\n\n  return JSON.stringify({\n    success: true,\n    newsId: newsId!,\n    created,\n    stackId: args.stackId || null,\n  });\n}\n\nasync function addNewsToStack(\n  args: { newsId: number; stackId: number },\n  ctx: ToolContext,\n): Promise<string> {\n  await StackService.addNews(args.stackId, args.newsId, ctx.clientId);\n\n  return JSON.stringify({\n    success: true,\n    newsId: args.newsId,\n    stackId: args.stackId,\n  });\n}\n\nasync function updateStack(\n  args: { stackId: number; description?: string; title?: string; time?: string },\n  ctx: ToolContext,\n): Promise<string> {\n  const data: any = {};\n  if (args.description !== undefined) data.description = args.description;\n  if (args.title !== undefined) data.title = args.title;\n  if (args.time !== undefined) data.time = new Date(args.time);\n\n  const result = await StackService.updateStack({\n    id: args.stackId,\n    data,\n    clientId: ctx.clientId,\n  });\n\n  if (result.status === 201) {\n    const socket = await EventService.getNewsroomSocket(ctx.eventId);\n    socket.emit('update stack', result.message);\n  }\n\n  return JSON.stringify({\n    success: true,\n    stackId: args.stackId,\n    message: result.message.message,\n  });\n}\n\nasync function reorderStacks(\n  args: { stackIds: number[] },\n  ctx: ToolContext,\n): Promise<string> {\n  const stacks = args.stackIds.map((stackId, index) => ({\n    stackId,\n    order: args.stackIds.length - 1 - index, // First in array gets highest order\n  }));\n\n  await sequelize.transaction(async (transaction) => {\n    const queue = stacks.map(({ stackId, order }) =>\n      StackService.updateStack({\n        id: stackId,\n        data: { order },\n        clientId: ctx.clientId,\n        transaction,\n      }),\n    );\n    await Promise.all(queue);\n\n    await RecordService.create(\n      {\n        model: 'Event',\n        target: ctx.eventId,\n        owner: ctx.clientId,\n        action: 'updateStackOrders',\n        data: recordData({ stacks }, ctx),\n      },\n      { transaction },\n    );\n  });\n\n  const socket = await EventService.getNewsroomSocket(ctx.eventId);\n  socket.emit('update stack orders', {\n    eventId: ctx.eventId,\n    stacks,\n  });\n\n  return JSON.stringify({\n    success: true,\n    newOrder: stacks,\n  });\n}\n\nasync function sendChatMessage(\n  args: { text: string },\n  ctx: ToolContext,\n): Promise<string> {\n  await ChatService.sendMessage('newsroom', ctx.clientId, args.text, ctx.eventId);\n\n  return JSON.stringify({ success: true });\n}\n\nconst QUESTION_POLL_INTERVAL_MS = 2000;\nconst QUESTION_TIMEOUT_MS = 5 * 60 * 1000; // 5 minutes\n\nasync function askUserQuestion(\n  args: { question: string; options: string[] },\n  ctx: ToolContext,\n): Promise<string> {\n  // Format the question with numbered options\n  const optionLines = args.options.map((opt, i) => `${i + 1}. ${opt}`).join('\\n');\n  const formattedMessage = [\n    `❓ ${args.question}`,\n    '',\n    optionLines,\n    '',\n    '请回复选项编号，或直接输入你的想法。',\n  ].join('\\n');\n\n  // Send the question as a chat message\n  await ChatService.sendMessage('newsroom', ctx.botClientId, formattedMessage, ctx.eventId);\n\n  // Persist + emit status so the UI shows we're waiting\n  const waitingStatus = '等待用户回复...';\n  const timestamp = new Date().toISOString();\n  try {\n    await AgentStatus.create({\n      id: randomUUID(),\n      runId: ctx.runId,\n      eventId: ctx.eventId,\n      type: 'status',\n      status: waitingStatus,\n      authorId: ctx.botClientId,\n    } as any);\n  } catch (err: any) {\n    console.error('[AgentService] Failed to persist agent status:', err.message);\n  }\n  const socket = await EventService.getNewsroomSocket(ctx.eventId);\n  socket.emit('agent status', { eventId: ctx.eventId, status: waitingStatus, runId: ctx.runId, timestamp });\n\n  // Poll the inbox until the user responds or we time out\n  const startTime = Date.now();\n  while (Date.now() - startTime < QUESTION_TIMEOUT_MS) {\n    // Check if agent was stopped\n    if (await AgentLock.shouldStop(ctx.eventId)) {\n      return JSON.stringify({ error: 'Agent was stopped while waiting for user response.' });\n    }\n\n    const inboxMessages = await AgentLock.drainInbox(ctx.eventId);\n    if (inboxMessages.length > 0) {\n      const userReply = inboxMessages.join('\\n');\n\n      // Parse if the user replied with an option number\n      const trimmed = userReply.trim();\n      const optionNum = parseInt(trimmed, 10);\n      if (optionNum >= 1 && optionNum <= args.options.length && trimmed === String(optionNum)) {\n        return JSON.stringify({\n          selectedOption: optionNum,\n          selectedText: args.options[optionNum - 1],\n          rawResponse: userReply,\n        });\n      }\n\n      // Free-form response\n      return JSON.stringify({\n        selectedOption: null,\n        selectedText: null,\n        rawResponse: userReply,\n      });\n    }\n\n    // Wait before polling again\n    await new Promise(resolve => setTimeout(resolve, QUESTION_POLL_INTERVAL_MS));\n\n    // Refresh the lock TTL so it doesn't expire while we wait\n    await AgentLock.refreshLock(ctx.eventId);\n  }\n\n  return JSON.stringify({ error: 'No response received within the time limit.' });\n}\n\nasync function createEvent(\n  args: { name: string; description: string },\n  ctx: ToolContext,\n): Promise<string> {\n  const existing = await EventService.findEvent(args.name);\n  if (existing) {\n    throw new Error('An event with this name already exists.');\n  }\n\n  const pinyin = await EventService.generatePinyin(args.name);\n\n  let event: any;\n  await sequelize.transaction(async (transaction) => {\n    event = await Event.create(\n      {\n        name: args.name,\n        description: args.description,\n        status: 'admitted',\n        pinyin,\n        ownerId: ctx.clientId,\n      },\n      { transaction },\n    );\n\n    await RecordService.create(\n      {\n        model: 'Event',\n        data: recordData(event, ctx),\n        action: 'createEvent',\n        owner: ctx.clientId,\n        target: event.id,\n      },\n      { transaction },\n    );\n  });\n\n  await setClientEventOwner(ctx.clientId, event.id);\n\n  const client = await Client.findByPk(ctx.clientId);\n  const username = client?.username || 'surge';\n  await RedisService.set(RedisService.getEventIdKey(event.name, event.ownerId), event.id);\n  await RedisService.set(RedisService.getEventIdKey(event.name, username), event.id);\n\n  return JSON.stringify({\n    success: true,\n    eventId: event.id,\n    name: event.name,\n    pinyin: event.pinyin,\n  });\n}\n\nasync function getNewsroomLink(ctx: ToolContext): Promise<string> {\n  const event = await EventService.findEvent(ctx.eventId, { eventOnly: true });\n  if (!event) {\n    throw new Error('Event not found.');\n  }\n\n  const client = await Client.findByPk(event.ownerId);\n  const username = client?.username || 'surge';\n  const siteBase = process.env.SITE_URL || 'https://langchao.org';\n  const eventPath = `/@${username}/${Math.abs(event.id)}-${event.pinyin}`;\n  const newsroomUrl = `${siteBase}${eventPath}/newsroom`;\n\n  return JSON.stringify({\n    success: true,\n    eventId: event.id,\n    eventName: event.name,\n    newsroomUrl,\n  });\n}\n\nasync function updateEventTool(\n  args: { name?: string; description?: string },\n  ctx: ToolContext,\n): Promise<string> {\n  const event = await EventService.findEvent(ctx.eventId, { eventOnly: true });\n  if (!event) {\n    throw new Error('Event not found.');\n  }\n\n  const client = await Client.findByPk(ctx.clientId);\n  if (!client) {\n    throw new Error('Client not found.');\n  }\n\n  const updated = await EventService.updateEvent(event, args as any, client);\n\n  const socket = await EventService.getNewsroomSocket(ctx.eventId);\n  socket.emit('update event', updated);\n\n  return JSON.stringify({\n    success: true,\n    eventId: updated.id,\n    name: updated.name,\n    description: updated.description,\n  });\n}\n\nasync function removeNewsFromStack(\n  args: { newsId: number; stackId: number },\n  ctx: ToolContext,\n): Promise<string> {\n  await StackService.removeNews(args.stackId, args.newsId, ctx.clientId);\n\n  const socket = await EventService.getNewsroomSocket(ctx.eventId);\n  socket.emit('remove news from stack', {\n    newsId: args.newsId,\n    stackId: args.stackId,\n    eventId: ctx.eventId,\n  });\n\n  return JSON.stringify({\n    success: true,\n    newsId: args.newsId,\n    stackId: args.stackId,\n  });\n}\n\nasync function searchEventsInDb(\n  args: { query: string; page?: number },\n): Promise<string> {\n  const hits = await AlgoliaService.searchEvents(args.query, args.page ?? 1) as any[];\n\n  return JSON.stringify({\n    results: hits,\n    count: hits.length,\n  });\n}\n\nasync function getEditorialGuidelines(): Promise<string> {\n  return JSON.stringify({ guidelines: SYSTEM_PROMPT });\n}\n\nasync function getFollowedEditableEvents(ctx: ToolContext): Promise<string> {\n  const subscriptions = await Subscription.findAll({\n    where: { subscriber: ctx.clientId, status: 'active' },\n    include: [{ model: Event, as: 'event' }],\n  });\n\n  const results: any[] = [];\n  for (const sub of subscriptions) {\n    const event = (sub as any).event as Event | null;\n    if (!event || event.status === 'removed') continue;\n    if (await isAllowedToEditEvent(ctx.clientId, event.id)) {\n      results.push({\n        id: event.id,\n        name: event.name,\n        description: event.description,\n        status: event.status,\n      });\n    }\n  }\n\n  return JSON.stringify({ events: results, count: results.length });\n}\n\nasync function getOwnedEditableEvents(ctx: ToolContext): Promise<string> {\n  const events = await Event.findAll({\n    where: { ownerId: ctx.clientId },\n    attributes: ['id', 'name', 'description', 'status'],\n    order: [['id', 'DESC']],\n  });\n\n  const results = events\n    .filter(e => e.status !== 'removed')\n    .map(e => ({\n      id: e.id,\n      name: e.name,\n      description: e.description,\n      status: e.status,\n    }));\n\n  return JSON.stringify({ events: results, count: results.length });\n}\n"],"sourceRoot":"../../../../src"}