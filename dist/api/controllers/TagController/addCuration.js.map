{"version":3,"sources":["../api/controllers/TagController/addCuration.ts"],"names":[],"mappings":";;;;;;;;;;;AACA,yCAAuC;AAEvC,SAAe,WAAW,CAAC,GAAoB,EAAE,GAAqB;;QACpE,MAAM,KAAK,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC;QAChC,MAAM,SAAS,GAAG,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC;QACvC,MAAM,OAAO,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC;QACpC,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,GAAG,CAAC,IAAI,CAAC;QACpC,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;gBAC1B,OAAO,EAAE,eAAe;aACzB,CAAC,CAAC;SACJ;QAED,IAAI,CAAC,CAAC,WAAW,EAAE,kBAAkB,EAAE,SAAS,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;YACjE,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;gBAC1B,OAAO,EAAE,0DAA0D;aACpE,CAAC,CAAC;SACJ;QAED,MAAM,QAAQ,GAAG,MAAM,sBAAU,CAAC,WAAW,CAAC,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;QACzF,IAAI,QAAQ,EAAE;YACZ,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;gBACnB,OAAO,EAAE,QAAQ;gBACjB,QAAQ;aACT,CAAC,CAAC;SACJ;aAAM;YACL,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;gBACnB,OAAO,EAAE,MAAM;aAChB,CAAC,CAAC;SACJ;IACH,CAAC;CAAA;AAED,kBAAe,WAAW,CAAC","file":"addCuration.js","sourcesContent":["import { RedstoneRequest, RedstoneResponse } from '@Types';\nimport { TagService } from '@Services';\n\nasync function addCuration(req: RedstoneRequest, res: RedstoneResponse) {\n  const tagId = +req.params.tagId;\n  const curatorId = req.session.clientId;\n  const eventId = +req.params.eventId;\n  const { state, comment } = req.body;\n  if (!eventId) {\n    return res.status(400).json({\n      message: '缺失参数: eventId',\n    });\n  }\n\n  if (!['certified', 'need improvement', 'warning'].includes(state)) {\n    return res.status(400).json({\n      message: '参数 state 必须为 \"certified\", \"need improvement\" 或 \"warning\"',\n    });\n  }\n\n  const curation = await TagService.addCuration(tagId, curatorId, eventId, state, comment);\n  if (curation) {\n    res.status(201).json({\n      message: '成功添加点评',\n      curation,\n    });\n  } else {\n    res.status(200).json({\n      message: '添加失败',\n    });\n  }\n}\n\nexport default addCuration;\n"],"sourceRoot":"../../../../src"}