{"version":3,"sources":["../api/controllers/StackController/updateStack.ts"],"names":[],"mappings":";;;;;;;;;;;AACA,qCAAoC;AACpC,yCAAyC;AAEzC,SAAe,WAAW,CAAE,GAAoB,EAAE,GAAqB;;QACrE,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC;QAC/B,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;QAEtB,IAAI;YACF,MAAM,mBAAS,CAAC,WAAW,CAAC,CAAM,WAAW,EAAC,EAAE;gBAC9C,MAAM,EAAE,GAAG,MAAM,wBAAY,CAAC,WAAW,CAAC;oBACxC,EAAE;oBACF,IAAI;oBACJ,QAAQ,EAAE,GAAG,CAAC,OAAO,CAAC,QAAQ;oBAC9B,WAAW;iBACZ,CAAC,CAAC;gBACH,OAAO,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;YAChD,CAAC,CAAA,CAAC,CAAC;SACJ;QAAC,OAAO,GAAG,EAAE;YACZ,IAAI,GAAG,CAAC,OAAO,KAAK,0BAA0B,EAAE;gBAC9C,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;aACvD;SACF;IACH,CAAC;CAAA;AAED,kBAAe,WAAW,CAAC","file":"updateStack.js","sourcesContent":["import { RedstoneRequest, RedstoneResponse } from '@Types';\nimport { sequelize } from '@Models';\nimport { StackService } from '@Services';\n\nasync function updateStack (req: RedstoneRequest, res: RedstoneResponse) {\n  const id = +req.params.stackId;\n  const data = req.body;\n\n  try {\n    await sequelize.transaction(async transaction => {\n      const cb = await StackService.updateStack({\n        id,\n        data,\n        clientId: req.session.clientId,\n        transaction,\n      });\n      return res.status(cb.status).json(cb.message);\n    });\n  } catch (err) {\n    if (err.message === '一个进展必须在含有一个已过审新闻的情况下方可开放') {\n      return res.status(400).json({ message: err.message });\n    }\n  }\n}\n\nexport default updateStack;\n"],"sourceRoot":"../../../../src"}