{"version":3,"sources":["../api/controllers/AuthController/weibo.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,iDAAiD;AACjD,qCAA+B;AAC/B,uCAA0C;AAG1C,SAAe,KAAK,CAAC,GAAoB,EAAE,GAAqB;;QAC9D,MAAM,EAAE,GAAG,gBAAK,CAAC,KAAK,CAAC;QAEvB,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;gBAC1B,OAAO,EAAE,UAAU;aACpB,CAAC,CAAC;SACJ;QAED,MAAM,IAAI,GAAG,MAAM,cAAI,CAAC,MAAM,CAAC;YAC7B,IAAI,EAAE,OAAO;YACb,KAAK,EAAE,GAAG,CAAC,OAAO,CAAC,QAAQ;YAC3B,QAAQ,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;YAC7C,UAAU,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE;SAClD,CAAC,CAAC;QAEH,MAAM,QAAQ,GAAG,kBAAO,CAAC,GAAG,GAAG,sBAAsB,CAAC;QAEtD,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAE,EAAE,CAAC,eAAe,CAAC;YACnC,YAAY,EAAE,QAAQ;YACtB,KAAK,EAAE,IAAI,CAAC,EAAE;SACf,CAAC,CAAC,CAAC;IACN,CAAC;CAAA;AAED,kBAAe,KAAK,CAAC","file":"weibo.js","sourcesContent":["/* eslint-disable @typescript-eslint/camelcase */\nimport { Auth } from '@Models';\nimport { oauth, globals } from '@Configs';\nimport { RedstoneRequest, RedstoneResponse } from '@Types';\n\nasync function weibo(req: RedstoneRequest, res: RedstoneResponse) {\n  const oa = oauth.weibo;\n\n  if (!oa) {\n    return res.status(503).json({\n      message: '暂不支持微博绑定',\n    });\n  }\n\n  const auth = await Auth.create({\n    site: 'weibo',\n    owner: req.session.clientId,\n    redirect: req.query ? req.query.redirect : '',\n    inviteCode: req.query ? req.query.inviteCode : '',\n  });\n\n  const callback = globals.api + '/auth/weibo/callback';\n\n  res.redirect(307, oa.getAuthorizeUrl({\n    redirect_uri: callback,\n    state: auth.id,\n  }));\n}\n\nexport default weibo;\n"],"sourceRoot":"../../../../src"}